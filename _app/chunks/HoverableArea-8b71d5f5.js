import{S as P,i as W,s as k,D as Q,e as j,j as E,c as C,a as A,d as v,l as M,b as c,L,M as X,f as z,H as S,N as y,E as Y,F as Z,G as B,p as J,n as K,O as R,q,u as U,C as F,P as D,I as H,Q as N}from"./vendor-0e8cf8c4.js";function x(t){let e,s,h,a,u,g,p,d,b,i,r,_,w;const m=t[10].default,n=Q(m,t,t[9],null);return{c(){e=j("div"),s=j("map"),n&&n.c(),h=E(),a=j("img"),p=E(),d=j("canvas"),b=E(),i=j("span"),this.h()},l(o){e=C(o,"DIV",{class:!0});var f=A(e);s=C(f,"MAP",{name:!0});var I=A(s);n&&n.l(I),I.forEach(v),h=M(f),a=C(f,"IMG",{src:!0,alt:!0,usemap:!0,class:!0}),p=M(f),d=C(f,"CANVAS",{style:!0,class:!0}),A(d).forEach(v),b=M(f),i=C(f,"SPAN",{class:!0}),A(i).forEach(v),f.forEach(v),this.h()},h(){c(s,"name",t[0]),L(a.src,u=t[1])||c(a,"src",u),c(a,"alt",t[2]),c(a,"usemap",g="#"+t[0]),c(a,"class","svelte-1bj5jt9"),X(d,"pointer-events","none"),c(d,"class","svelte-1bj5jt9"),c(i,"class","svelte-1bj5jt9"),c(e,"class","container svelte-1bj5jt9")},m(o,f){z(o,e,f),S(e,s),n&&n.m(s,null),S(e,h),S(e,a),t[11](a),S(e,p),S(e,d),t[12](d),S(e,b),S(e,i),t[13](i),r=!0,_||(w=[y(window,"resize",t[6]),y(a,"load",t[6]),y(a,"resize",t[6]),y(a,"mousemove",t[7])],_=!0)},p(o,[f]){n&&n.p&&(!r||f&512)&&Y(n,m,o,o[9],r?B(m,o[9],f,null):Z(o[9]),null),(!r||f&1)&&c(s,"name",o[0]),(!r||f&2&&!L(a.src,u=o[1]))&&c(a,"src",u),(!r||f&4)&&c(a,"alt",o[2]),(!r||f&1&&g!==(g="#"+o[0]))&&c(a,"usemap",g)},i(o){r||(J(n,o),r=!0)},o(o){K(n,o),r=!1},d(o){o&&v(e),n&&n.d(o),t[11](null),t[12](null),t[13](null),_=!1,R(w)}}}function $(t,e,s){let{$$slots:h={},$$scope:a}=e;const u=F(1);q("ratioStore",u);let{mapId:g}=e,{src:p}=e,{pixelWidth:d}=e,{alt:b}=e,i;const r=F(i);q("canvasStore",r);let _,w,m=1;const n=()=>{f(d,(_==null?void 0:_.width)||1),i&&(s(3,i.width=_.width,i),s(3,i.height=_.height,i))},o=l=>{s(5,w.textContent=(l.offsetX/m).toFixed(1)+","+(l.offsetY/m).toFixed(1),w)},f=(l,V)=>{m=l/(V||1),u.set(m),console.log(`set ratio to ${m}`)};U(()=>{n(),r.set(i)});function I(l){D[l?"unshift":"push"](()=>{_=l,s(4,_)})}function T(l){D[l?"unshift":"push"](()=>{i=l,s(3,i)})}function G(l){D[l?"unshift":"push"](()=>{w=l,s(5,w)})}return t.$$set=l=>{"mapId"in l&&s(0,g=l.mapId),"src"in l&&s(1,p=l.src),"pixelWidth"in l&&s(8,d=l.pixelWidth),"alt"in l&&s(2,b=l.alt),"$$scope"in l&&s(9,a=l.$$scope)},t.$$.update=()=>{t.$$.dirty&8&&r.set(i)},[g,p,b,i,_,w,n,o,d,a,h,I,T,G]}class le extends P{constructor(e){super();W(this,e,$,x,k,{mapId:0,src:1,pixelWidth:8,alt:2})}}const oe=t=>t.replace("'","").split(/[^0-9a-zA-Z]+/g).map(e=>e.toLowerCase()).join("_"),O=(t,e)=>{e=[...e];const[s,h]=e.pop();for(t.moveTo(s,h),t.beginPath();e.length;){let[a,u]=e.pop();t.lineTo(a,u)}t.lineTo(s,h),t.closePath(),t.stroke()},ee=(t,e)=>{const s=t.getContext("2d");s.setLineDash([15,15]),s.lineWidth=4,s.strokeStyle="rgba(256, 256, 256, .75)",O(s,e)},ie=(t,e)=>{const s=t.getContext("2d");s.setLineDash([0,0]),s.lineWidth=4,s.strokeStyle="#fff",O(s,e)},te=t=>{t.getContext("2d").clearRect(0,0,t.width,t.height)};function se(t){let e,s,h;return{c(){e=j("area"),this.h()},l(a){e=C(a,"AREA",{shape:!0,coords:!0,alt:!0,href:!0}),this.h()},h(){c(e,"shape","poly"),c(e,"coords",t[2]),c(e,"alt",t[1]),c(e,"href",t[0])},m(a,u){z(a,e,u),s||(h=[y(e,"mouseenter",t[3]),y(e,"mouseleave",t[4])],s=!0)},p(a,[u]){u&4&&c(e,"coords",a[2]),u&2&&c(e,"alt",a[1]),u&1&&c(e,"href",a[0])},i:H,o:H,d(a){a&&v(e),s=!1,R(h)}}}function ae(t,e,s){let h,a,{draw:u=ee}=e,{href:g=""}=e,{alt:p=""}=e,{coords:d=[]}=e,b=1;const i=N("ratioStore");let r;const _=N("canvasStore");i.subscribe(n=>s(7,b=n)),_.subscribe(n=>r=n);const w=()=>{r&&u(r,h)},m=()=>{r&&te(r)};return t.$$set=n=>{"draw"in n&&s(5,u=n.draw),"href"in n&&s(0,g=n.href),"alt"in n&&s(1,p=n.alt),"coords"in n&&s(6,d=n.coords)},t.$$.update=()=>{t.$$.dirty&192&&s(8,h=d.map(n=>n.map(o=>o/b))),t.$$.dirty&256&&s(2,a=h.map(n=>n.join(",")).join(","))},[g,p,a,w,m,u,d,b,h]}class re extends P{constructor(e){super();W(this,e,ae,se,k,{draw:5,href:0,alt:1,coords:6})}}export{re as H,le as I,ee as d,ie as r,oe as s};
