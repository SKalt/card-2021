import{S as z,i as F,s as H,D as U,e as S,j as P,c as I,a as E,d as C,l as W,b as u,L as N,M as Z,f as O,H as j,N as y,E as x,F as $,G as ee,p as te,n as se,O as T,q as D,u as ae,C as G,P as R,I as L,Q as V}from"./vendor-0e8cf8c4.js";function ne(t){let e,a,_,s,f,p,v,d,w,g,l,c,o;const b=t[10].default,h=U(b,t,t[9],null);return{c(){e=S("div"),a=S("map"),h&&h.c(),_=P(),s=S("img"),v=P(),d=S("canvas"),w=P(),g=S("span"),this.h()},l(r){e=I(r,"DIV",{class:!0});var i=E(e);a=I(i,"MAP",{name:!0});var A=E(a);h&&h.l(A),A.forEach(C),_=W(i),s=I(i,"IMG",{src:!0,alt:!0,usemap:!0,class:!0}),v=W(i),d=I(i,"CANVAS",{style:!0,class:!0}),E(d).forEach(C),w=W(i),g=I(i,"SPAN",{class:!0}),E(g).forEach(C),i.forEach(C),this.h()},h(){u(a,"name",t[0]),N(s.src,f=t[1])||u(s,"src",f),u(s,"alt",t[2]),u(s,"usemap",p="#"+t[0]),u(s,"class","svelte-1bj5jt9"),Z(d,"pointer-events","none"),u(d,"class","svelte-1bj5jt9"),u(g,"class","svelte-1bj5jt9"),u(e,"class","container svelte-1bj5jt9")},m(r,i){O(r,e,i),j(e,a),h&&h.m(a,null),j(e,_),j(e,s),t[12](s),j(e,v),j(e,d),t[13](d),j(e,w),j(e,g),t[14](g),l=!0,c||(o=[y(window,"resize",t[6]),y(s,"load",t[11]),y(s,"resize",t[6]),y(s,"mousemove",t[7])],c=!0)},p(r,[i]){h&&h.p&&(!l||i&512)&&x(h,b,r,r[9],l?ee(b,r[9],i,null):$(r[9]),null),(!l||i&1)&&u(a,"name",r[0]),(!l||i&2&&!N(s.src,f=r[1]))&&u(s,"src",f),(!l||i&4)&&u(s,"alt",r[2]),(!l||i&1&&p!==(p="#"+r[0]))&&u(s,"usemap",p)},i(r){l||(te(h,r),l=!0)},o(r){se(h,r),l=!1},d(r){r&&C(e),h&&h.d(r),t[12](null),t[13](null),t[14](null),c=!1,T(o)}}}function le(t,e,a){let{$$slots:_={},$$scope:s}=e;const f=G([]);D("draw",f);const p=G(1);D("ratioStore",p);let{mapId:v}=e,{src:d}=e,{pixelWidth:w}=e,{alt:g}=e,l,c,o,b=1;const h=()=>{i(w,(c==null?void 0:c.width)||1),l&&(a(3,l.width=c.width,l),a(3,l.height=c.height,l))},r=n=>{a(5,o.textContent=(n.offsetX/b).toFixed(1)+","+(n.offsetY/b).toFixed(1),o)},i=(n,m)=>{b=n/(m||1),p.set(b),console.log(`set ratio to ${b}`)};ae(()=>{i(w,c==null?void 0:c.width)});const A=n=>{if(console.log("redrawing"),!l){console.log("missing canvas");return}const m=l.getContext("2d");if(!n.length)m.clearRect(0,0,m.canvas.width,m.canvas.height);else{const M=[...n],[k,q]=M.pop();for(m.lineWidth=4,m.strokeStyle="#fff",m.moveTo(k,q),m.beginPath();M.length;){let[J,K]=M.pop();m.lineTo(J,K)}m.lineTo(k,q),m.closePath(),m.stroke()}};f.subscribe(A);const Q=()=>{h()};function X(n){R[n?"unshift":"push"](()=>{c=n,a(4,c)})}function Y(n){R[n?"unshift":"push"](()=>{l=n,a(3,l)})}function B(n){R[n?"unshift":"push"](()=>{o=n,a(5,o)})}return t.$$set=n=>{"mapId"in n&&a(0,v=n.mapId),"src"in n&&a(1,d=n.src),"pixelWidth"in n&&a(8,w=n.pixelWidth),"alt"in n&&a(2,g=n.alt),"$$scope"in n&&a(9,s=n.$$scope)},[v,d,g,l,c,o,h,r,w,s,_,Q,X,Y,B]}class ue extends z{constructor(e){super();F(this,e,le,ne,H,{mapId:0,src:1,pixelWidth:8,alt:2})}}function oe(t){let e,a,_;return{c(){e=S("area"),this.h()},l(s){e=I(s,"AREA",{shape:!0,coords:!0,alt:!0,href:!0}),this.h()},h(){u(e,"shape","poly"),u(e,"coords",t[2]),u(e,"alt",t[1]),u(e,"href",t[0])},m(s,f){O(s,e,f),a||(_=[y(e,"mouseenter",t[3]),y(e,"mouseleave",t[4])],a=!0)},p(s,[f]){f&4&&u(e,"coords",s[2]),f&2&&u(e,"alt",s[1]),f&1&&u(e,"href",s[0])},i:L,o:L,d(s){s&&C(e),a=!1,T(_)}}}function re(t,e,a){let _,s,{href:f=""}=e,{alt:p=""}=e,{coords:v=[]}=e,d=1;const w=V("ratioStore"),g=V("draw");w.subscribe(o=>a(6,d=o));const l=()=>{g.set(_)},c=()=>{g.set([])};return t.$$set=o=>{"href"in o&&a(0,f=o.href),"alt"in o&&a(1,p=o.alt),"coords"in o&&a(5,v=o.coords)},t.$$.update=()=>{t.$$.dirty&96&&a(7,_=v.map(o=>o.map(b=>b/d))),t.$$.dirty&128&&a(2,s=_.map(o=>o.join(",")).join(","))},[f,p,s,l,c,v,d,_]}class ce extends z{constructor(e){super();F(this,e,re,oe,H,{href:0,alt:1,coords:5})}}export{ce as H,ue as I};
